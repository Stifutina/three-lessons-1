import{S as I,T as R,ad as W,o as y,M as g,a0 as j,q as D,B as E,t as k,Q as F,P as H,W as O,a2 as V,v as U}from"./three.module-anhs7Ygx.js";/* empty css              */import{O as N}from"./OrbitControls-DvCuvUga.js";import{G as Q}from"./lil-gui.esm-hsJpI9MV.js";import{W as J,a as K,M as X,C as Y,P as Z,B as f,V as x,b as _,S as $}from"./cannon-es-C3cGVpou.js";const v=new Q,m={};m.createSphere=()=>{G(Math.random(),{x:(Math.random()-.5)*3,y:3,z:(Math.random()-.5)*3})};v.add(m,"createSphere");m.createBox=()=>{ie(Math.random(),Math.random(),Math.random(),{x:(Math.random()-.5)*3,y:3,z:(Math.random()-.5)*3})};v.add(m,"createBox");m.resetScene=()=>{for(const e of d)e.mesh.geometry.dispose(),e.mesh.material.dispose(),i.remove(e.mesh),o.removeBody(e.body);d.splice(0,d.length),d.length=0};v.add(m,"resetScene");const T=document.querySelector("canvas.webgl"),i=new I,l=new Audio("/sounds/hit.mp3");let B=0;l.preservesPitch=!1;const z=e=>{const a=e.contact.getImpactVelocityAlongNormal(),t=Date.now();console.log("collision",e),console.log("collision.body.mass",e.body.mass),a>1.5&&t-B>70&&(l.volume=Math.min(a*(e.target.mass/2)/10,1),l.playbackRate=.25+(3.75-e.target.mass/3),l.currentTime=0,l.play(),B=t)};new R;const ee=new W,S=ee.load(["/textures/environmentMaps/0/px.png","/textures/environmentMaps/0/nx.png","/textures/environmentMaps/0/py.png","/textures/environmentMaps/0/ny.png","/textures/environmentMaps/0/pz.png","/textures/environmentMaps/0/nz.png"]),te=new y({metalness:.3,roughness:.4,envMap:S,envMapIntensity:.5}),ae=new y({metalness:.3,roughness:.4,envMap:S}),o=new J;o.broadphase=new K(o);o.allowSleep=!0;o.gravity.set(0,-9.82,0);const w=new X("default"),L=new Y(w,w,{friction:.1,restitution:.7});o.addContactMaterial(L);o.defaultContactMaterial=L;const oe=new Z,u=new f;u.mass=0;u.addShape(oe);u.quaternion.setFromAxisAngle(new x(-1,0,0),Math.PI*.5);o.addBody(u);const b=new g(new j(10,10),new y({color:"#777777",metalness:.3,roughness:.4,envMap:S,envMapIntensity:.5}));b.receiveShadow=!0;b.rotation.x=-Math.PI*.5;i.add(b);const ne=new D(1,20,20),se=new E(1,1,1),d=[],re=new k(16777215,2.1);i.add(re);const r=new F(16777215,.6);r.castShadow=!0;r.shadow.mapSize.set(1024,1024);r.shadow.camera.far=15;r.shadow.camera.left=-7;r.shadow.camera.top=7;r.shadow.camera.right=7;r.shadow.camera.bottom=-7;r.position.set(5,5,5);i.add(r);const n={width:window.innerWidth,height:window.innerHeight};window.addEventListener("resize",()=>{n.width=window.innerWidth,n.height=window.innerHeight,h.aspect=n.width/n.height,h.updateProjectionMatrix(),c.setSize(n.width,n.height),c.setPixelRatio(Math.min(window.devicePixelRatio,2))});const h=new H(45,n.width/n.height,.1,100);h.position.set(-3,3,3);i.add(h);const C=new N(h,T);C.enableDamping=!0;const c=new O({canvas:T});c.shadowMap.enabled=!0;c.shadowMap.type=V;c.setSize(n.width,n.height);c.setPixelRatio(Math.min(window.devicePixelRatio,2));const G=(e,a)=>{const t=new g(ne,te);t.scale.set(e,e,e),t.castShadow=!0,t.position.copy(a),i.add(t);const M=new $(e),s=new f({mass:e*10,position:new x(a.x,a.y,a.z),shape:M,material:w});s.position.copy(a),s.addEventListener("collide",z),o.addBody(s),d.push({mesh:t,body:s})};G(.5,{x:0,y:3,z:0});const ie=(e,a,t,M)=>{const s=new g(se,ae);s.scale.set(e,a,t),s.castShadow=!0,i.add(s);const q=new _(new x(e/2,a/2,t/2)),p=new f({mass:1,shape:q,material:w});p.position.copy(M),p.addEventListener("collide",z),o.addBody(p),d.push({mesh:s,body:p})},de=new U;let P=0;const A=()=>{const e=de.getElapsedTime(),a=e-P;P=e,o.step(1/60,a,3);for(const t of d)t.mesh.position.copy(t.body.position),t.mesh.quaternion.copy(t.body.quaternion);C.update(),c.render(i,h),window.requestAnimationFrame(A)};A();
//# sourceMappingURL=lesson17-2p5zmm78.js.map
